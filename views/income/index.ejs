<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="shortcut icon" href="/images/isoGradient.png" type="image/x-icon">
	<link rel="stylesheet" href="/stylesheets/navs/nav.css">
	<link rel="stylesheet" href="/stylesheets/template.css">

	<title>Ingresos</title>
</head>
<body>
	<%- include('../navs/nav.ejs') %>
	<div class="box">
		
		<% if (categoryData.length > 0) { -%>
			<div>
			<h1>Ingresos:</h1>	
			</div>
			<hr>
			<!-- BOTON PARA AGREGAR NUEVO -->
			<div class="add">
				<button class="btnSecondary marginRight"><i class="fi fi-br-search"></i></button>
				<button id="addBtn" class="btnPrimary"><i class="fi fi-br-plus"></i></button>	
			</div>	
			<% for (let i = 0; i < categoryData.length; i++) { -%>
				<div class="tableSecondary marginVertical">
					<table>
						<thead>
							<tr class="titleTable">
								<th colspan="5"><%= categoryData[i].name %></th>
							</tr>
							<tr>
								<th width="8%">Semana</th>
								<th width="10%">Fecha</th>
								<th width="10%">Folio</th>
								<th>Concepto</th>
								<th width="10%"><i class="fi fi-br-dollar"></i></th>
							</tr>
						</thead>
						<tbody>
							<% for(let j = 0; j < incomeData.length; j++) { %>
								<% if(incomeData[j].categoryFK == categoryData[i].id){ %>
									<tr>
										<td style="text-align: center;"><%= incomeData[j].week %></td>
										<td><%= incomeData[j].date %></td>
										<td><%= incomeData[j].folio %></td>
										<td><%= incomeData[j].concept %></td>
										<td>
											<%= incomeData[j].mount %>
											<div class="trActions">
												<button class="btnAlert" id="deleteBtn"><i class="fi fi-br-cross"></i></button>
												<button class="btnPrimary" id="editBtn"><i class="fi fi-sr-pencil"></i></button>
											</div>
										</td>
									</tr>
								<% } %>
							<% } %>
						</tbody>
					</table>
				</div>
				<div class="seeAll marginBottom">
					<button class="btnAlert marginHorizontal"><i class="fi fi-sr-trash"></i></button>
					<a href="" class="btnPrimary">Ver todos</a>
				</div>
			<% } -%>
		<% } else { -%>
			<div style="text-align: center;">
				<p>No se ha ingresado ninguna categoria</p>
				<p>Ingresa una para continuar:</p>
				<a href="/category" class="btnSecondary">Categorias</a>
			</div>
		<% } -%>
	</div>

	<!-- MODAL PARA AÑADIR Y EDITAR-->

	<div class="modalAdd shadow" id="addModal" style="display: <%= addVisible %>;">
		<div>
			<h2>Añadir ingreso:</h2>	
		</div>
		<form method="post" action="/income/insert">
			<div class="date marginBottom">
				<input id="day" name="day" class="textForegroundAlphaPrimary" type="number" min="1" max="31" placeholder="Dia">
				<input id="month" name="month" class="textForegroundAlphaPrimary marginHorizontal" type="number" min="1" max="12" placeholder="Mes">
				<input id="year" name="year" class="textForegroundAlphaPrimary year" type="number" min="1900" max="3000" placeholder="Año">
			</div>
			<div>
				<input id="folio" name="folio" class="textForegroundAlphaPrimary" type="number" min="0" placeholder="Folio">
			</div>
			<div>
				<textarea name="concept" class="textForegroundAlphaPrimary marginVertical" id="" rows="2" placeholder="Concepto"></textarea>
			</div>
			<div>
				<label for="mount" class="dollar"><i class="fi fi-br-dollar"></i></label>
				<input id="mount" name="mount" class="textForegroundAlphaPrimary" type="number" min="1" placeholder="Monto">
			</div>
			<div>
				<select id="category" name="category" class="textForegroundAlphaPrimary marginTop">
					<% for( let i = 0; i < categoryData.length; i++ ) { %>
						<option value="<%= categoryData[i].id %>"><%= categoryData[i].name %></option>
					<% } %>
				</select>
			</div>
			<div class="buttons marginTop">
				<span id="cancelAdd" class="btnAlert">Cancelar</span>
				<input class="btnSecondary marginLeft" type="submit" value="Guardar">
			</div>
		</form>
		<% if(errors.length != 0){ %>
			<div class="errorBox">
				<% for (let i = 0; i < errors.length; i++) { %>
					<span class="alert"><%= errors[i] %></span>
				<% } %>
			</div>
		<% } %>
	</div>

	<script src="/javascripts/income.js"></script>
</body>
</html>